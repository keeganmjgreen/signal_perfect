
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Derivation - SignalPerfect</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#derivation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="SignalPerfect" class="md-header__button md-logo" aria-label="SignalPerfect" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SignalPerfect
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Derivation
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="SignalPerfect" class="md-nav__button md-logo" aria-label="SignalPerfect" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SignalPerfect
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Derivation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Derivation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#knot-constraint" class="md-nav__link">
    <span class="md-ellipsis">
      Knot constraint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#knot-derivative-constraint" class="md-nav__link">
    <span class="md-ellipsis">
      Knot derivative constraint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interval-average-constraint" class="md-nav__link">
    <span class="md-ellipsis">
      Interval average constraint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boundary-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Boundary conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Boundary conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zero-slope-boundary-conditions-variant" class="md-nav__link">
    <span class="md-ellipsis">
      "Zero-slope boundary conditions" variant
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zero-curvature-boundary-conditions-variant" class="md-nav__link">
    <span class="md-ellipsis">
      "Zero-curvature boundary conditions" variant
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#knot-constraint" class="md-nav__link">
    <span class="md-ellipsis">
      Knot constraint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#knot-derivative-constraint" class="md-nav__link">
    <span class="md-ellipsis">
      Knot derivative constraint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interval-average-constraint" class="md-nav__link">
    <span class="md-ellipsis">
      Interval average constraint
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boundary-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Boundary conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Boundary conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zero-slope-boundary-conditions-variant" class="md-nav__link">
    <span class="md-ellipsis">
      "Zero-slope boundary conditions" variant
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zero-curvature-boundary-conditions-variant" class="md-nav__link">
    <span class="md-ellipsis">
      "Zero-curvature boundary conditions" variant
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="derivation">Derivation</h1>
<p>The underlying signal is modeled by a quadratic spline. A spline is a piecewise polynomial. Each piece or segment of the spline is a polynomial and is separated by <span class="arithmatex">\(x\)</span>-values called knots. A spline is subject to constraints such at the knots, the <span class="arithmatex">\(y\)</span>-values of adjacent polynomial pieces are equal such that the pieces meet, and the derivatives of adjacent polynomial pieces are equal such that the spine is smooth and without kinks. The quadratic spline by which the underlying signal is modeled has an extra constraint such that its average value over each interval in the time series is equal to the value of that time series for that interval.</p>
<p>For all <span class="arithmatex">\(i\)</span> in <span class="arithmatex">\(\{1,\dots,n\}\)</span>:</p>
<div class="arithmatex">\[ f_i(t) = a_i t^2 + b_i t + c_i \]</div>
<p>We have <span class="arithmatex">\(3n\)</span> unknowns, and thus need <span class="arithmatex">\(3n\)</span> equations.</p>
<h2 id="knot-constraint">Knot constraint</h2>
<p>The <span class="arithmatex">\(y\)</span>-values of adjacent quadratic pieces must be equal to each other at each knot such that the pieces meet. Therefore, for all <span class="arithmatex">\(i\)</span> in <span class="arithmatex">\(\{1,\dots,n-1\}\)</span>:</p>
<div class="arithmatex">\[
\begin{aligned}
&amp; f_i(k_i)=f_{i+1}(k_i) \\
&amp; \implies a_i k_i^2 + b_i k_i + c_i = a_{i+1} k_i^2 + b_{i+1} k_i + c_{i+1} \\
&amp; \implies (-k_i^2) a_i + (-k_i) b_i + (-1) c_i + (k_i^2) a_{i+1} + (k_i) b_{i+1} + (1) c_{i+1} = 0
\end{aligned}
\]</div>
<p>This represents a set of <span class="arithmatex">\(n-1\)</span> linear equations, which can be expressed in the form <span class="arithmatex">\(A_1\mathbf{x}=\mathbf{b}_1\)</span>, where:</p>
<div class="arithmatex">\[ \mathbf{x} = \begin{bmatrix} a_1 &amp; b_1 &amp; c_1 &amp; \cdots &amp; a_n &amp; b_n &amp; c_n \end{bmatrix}^\mathrm{T} \]</div>
<div class="arithmatex">\[ \mathbf{b}_1 = \begin{bmatrix} 0 &amp; \dots &amp; 0 \end{bmatrix}^\mathrm{T} \]</div>
<pre><code class="language-python"># Written in Python:
b1 = np.zeros((n-1, 1))
</code></pre>
<div class="arithmatex">\[
A_1 =
\begin{bmatrix}
    -k_1^2 &amp; -k_1 &amp; -1 &amp; k_1^2 &amp; k_1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; -k4^2 &amp; -k_2 &amp; -1 &amp; k_2^2 &amp; k_2 &amp; 1 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; -k_n^2 &amp; -k_n &amp; -1 &amp; k_n^2 &amp; k_n &amp; 1
\end{bmatrix}
\]</div>
<pre><code class="language-python">A1 = np.array([[0, 0, 0] * (i-1) + [-k[i]**2, -k[i], -1, k[i]**2, k[i], 1] + [0, 0, 0] * (n-i-1) for i in range(1, n)])
</code></pre>
<p>When using <code>numpy.PPoly</code>, however, each polynomial piece, regardless of what range on the <span class="arithmatex">\(x\)</span>-axis it spans in the piecewise function,  is expressed in terms of <span class="arithmatex">\(x\)</span> starting at zero. This is a way of "normalizing" each polynomial and avoiding sensitive coefficients. Thus, the <span class="arithmatex">\(k_i\)</span> for an <span class="arithmatex">\((a_i,b_i,c_i)\)</span> triple is replaced with zero and the <span class="arithmatex">\(k_i\)</span> for an <span class="arithmatex">\((a_{i+1},b_{i+1},c_{i+1})\)</span> triple is replaced with its distance from zero, <span class="arithmatex">\(k_i-k_{i-1}\)</span>, as follows:</p>
<div class="arithmatex">\[
A_1 =
\begin{bmatrix}
    -(k_1 - k_0)^2 &amp; -(k_1 - k_0) &amp; -1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; -(k_2 - k_1)^2 &amp; -(k_2 - k_1) &amp; -1 &amp; 0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; -(k_n - k_{n-1})^2 &amp; -(k_n - k_{n-1}) &amp; -1 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
\]</div>
<pre><code class="language-python">A1 = np.array([[0, 0, 0] * (i-1) + [-(k[i] - k[i-1])**2, -(k[i] - k[i-1]), -1, 0, 0, 1] + [0, 0, 0] * (n-i-1) for i in range(1, n)])
</code></pre>
<p>We need <span class="arithmatex">\(2n+1\)</span> more equations.</p>
<h2 id="knot-derivative-constraint">Knot derivative constraint</h2>
<p>The derivatives of adjacent quadratic pieces must be equal to each other at each knot such that the spine is smooth and without kinks. The derivative of quadratic piece <span class="arithmatex">\(i\)</span> is:</p>
<div class="arithmatex">\[ f_i'(t) = 2 a_i t + b_i \]</div>
<p>Therefore, for all <span class="arithmatex">\(i\)</span> in <span class="arithmatex">\(\{1,\dots,n-1\}\)</span>:</p>
<div class="arithmatex">\[
\begin{aligned}
&amp; f_i'(k_i)=f_{i+1}'(k_i) \\
&amp; \implies 2 a_i k_i + b_i = 2 a_{i+1} k_i + b_{i+1} \\
&amp; \implies (-2 k_i) a_i + (-1) b_i + (2 k_i) a_{i+1} + (1) b_{i+1} = 0
\end{aligned}
\]</div>
<p>This represents another <span class="arithmatex">\(n-1\)</span> linear equations, which can be expressed in the form <span class="arithmatex">\(A_2\mathbf{x}=\mathbf{b}_2\)</span>, where <span class="arithmatex">\(\mathbf{x}\)</span> is the same as before and:</p>
<div class="arithmatex">\[ \mathbf{b}_2 = \begin{bmatrix} 0 &amp; \dots &amp; 0 \end{bmatrix}^\mathrm{T} \]</div>
<pre><code class="language-python">b2 = np.zeros((n-1, 1))
</code></pre>
<div class="arithmatex">\[
A_2 =
\begin{bmatrix}
    -2 k_1 &amp; -1 &amp; 0 &amp; 2 k_1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; -2 k_2 &amp; -1 &amp; 0 &amp; 2 k_2 &amp; 1 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; -2 k_n &amp; -1 &amp; 0 &amp; 2 k_n &amp; 1 &amp; 0
\end{bmatrix}
\]</div>
<pre><code class="language-python">A2 = np.array([[0, 0, 0] * (i-1) + [-2 * k[i], -1, 0, 2 * k[i], 1, 0] + [0, 0, 0] * (n-i-1)  for i in range(1, n)])
</code></pre>
<p>Again, replacing the <span class="arithmatex">\(k_i\)</span> for each <span class="arithmatex">\((a_i,b_i,c_i)\)</span> triple with zero, and replacing the <span class="arithmatex">\(k_i\)</span> for each <span class="arithmatex">\((a_{i+1},b_{i+1},c_{i+1})\)</span> triple with <span class="arithmatex">\(k_i-k_{i-1}\)</span>, yields:</p>
<div class="arithmatex">\[
A_2 =
\begin{bmatrix}
    -2 (k_1 - k_0) &amp; -1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; -2 (k_2 - k_1) &amp; -1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; -2 (k_n - k_{n-1}) &amp; -1 &amp; 0 &amp; 0 &amp; 1 &amp; 0
\end{bmatrix}
\]</div>
<pre><code class="language-python">A2 = np.array([[0, 0, 0] * (i-1) + [-2 * (k[i] - k[i-1]), -1, 0, 0, 1, 0] + [0, 0, 0] * (n-i-1)  for i in range(1, n)])
</code></pre>
<p>Now we need <span class="arithmatex">\(n+2\)</span> more equations.</p>
<h2 id="interval-average-constraint">Interval average constraint</h2>
<p>The average value of the quadratic spline over each interval in the time series <span class="arithmatex">\(y[t]\)</span> must be equal to the value of that time series for that interval. The spline's average over an interval is expressed in terms of the definite integral of each quadratic piece divided by the width of the interval. The indefinite integral is:</p>
<div class="arithmatex">\[ F_i(t) = \int f_i(t) \ \mathrm{d}t = \frac{a_i}{3} t^3 + \frac{b_i}{2} t^2 + c_i t + C \]</div>
<p>In the "zero-derivative boundary conditions" variant, the knots separate the intervals in the time series. Therefore, for all <span class="arithmatex">\(i\)</span> in <span class="arithmatex">\(\{1,\dots,n\}\)</span>:</p>
<div class="arithmatex">\[
\begin{aligned}
&amp; \text{average over interval } i = \frac{1}{k_i - k_{i-1}} \int_{k_{i-1}}^{k_i} f_i(t) \ \mathrm{d}t = \frac{1}{k_i - k_{i-1}} (F_i(k_i) - F_i(k_{i-1})) = y[i] \\
&amp; \implies F_i(k_i) - F_i(k_{i-1}) = (k_i - k_{i-1}) \ y[i] \\
&amp; \implies \left( \frac{a_i}{3} k_i^3 + \frac{b_i}{2} k_i^2 + c_i k_i + C \right) - \left( \frac{a_i}{3} k_{i-1}^3 + \frac{b_i}{2} k_{i-1}^2 + c_i k_{i-1} + C \right) = (k_i - k_{i-1}) \ y[i] \\
&amp; \implies 2 a_i k_i^3 + 3 b_i k_i^2 + 6 c_i k_i - 2 a_i k_{i-1}^3 - 3 b_i k_{i-1}^2 - 6 c_i k_{i-1} = 6 (k_i - k_{i-1}) \ y[i] \\
&amp; \implies 2 (k_i^3 - k_{i-1}^3) a_i + 3 (k_i^2 - k_{i-1}^2) b_i + 6 (k_i - k_{i-1}) c_i = 6 (k_i - k_{i-1}) \ y[i]
\end{aligned}
\]</div>
<p>This represents another <span class="arithmatex">\(n\)</span> linear equations, which can be expressed in the form <span class="arithmatex">\(A_3\mathbf{x}=\mathbf{b}_3\)</span>, where <span class="arithmatex">\(\mathbf{x}\)</span> is the same as before and:</p>
<div class="arithmatex">\[
\mathbf{b}_3 =
\begin{bmatrix}
    6 (k_1 - k_0) \ y[1] \\
    6 (k_2 - k_1) \ y[2] \\
    \dots \\
    6 (k_n - k_{n-1}) \ y[n]
\end{bmatrix}
\]</div>
<pre><code class="language-python">b3 = np.array([[6 * y[i] * (k[i] - k[i-1])] for i in range(1, n+1)])
</code></pre>
<div class="arithmatex">\[
A_3 =
\begin{bmatrix}
    2 (k_1^3 - k_0^3) &amp; 3 (k_1^2 - k_0^2) &amp; 6 (k_1 - k_0) &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 2 (k_2^3 - k_1^3) &amp; 3 (k_2^2 - k_1^2) &amp; 6 (k_2 - k_1) &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 2 (k_n^3 - k_{n-1}^3) &amp; 3 (k_n^2 - k_{n-1}^2) &amp; 6 (k_n - k_{n-1})
\end{bmatrix}
\]</div>
<pre><code class="language-python">A3 = np.array([[0, 0, 0] * (i-1) + [2 * (k[i]**3 - k[i-1]**3), 3 * (k[i]**2 - k[i-1]**2), 6 * (k[i] - k[i-1])] + [0, 0, 0] * (n-i) for i in range(1, n+1)])
</code></pre>
<p>Replacing the <span class="arithmatex">\(k_i\)</span> and <span class="arithmatex">\(k_{i+1}\)</span> for each <span class="arithmatex">\((a_i,b_i,c_i)\)</span> triple with zero and <span class="arithmatex">\(k_i-k_{i-1}\)</span> respectively yields:</p>
<div class="arithmatex">\[
A_3 =
\begin{bmatrix}
    2 (k_1 - k_0)^3 &amp; 3 (k_1 - k_0)^2 &amp; 6 (k_1 - k_0) &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 2 (k_2 - k_1)^3 &amp; 3 (k_2 - k_1)^2 &amp; 6 (k_2 - k_1) &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 2 (k_n - k_{n-1})^3 &amp; 3 (k_n - k_{n-1})^2 &amp; 6 (k_n - k_{n-1})
\end{bmatrix}
\]</div>
<pre><code class="language-python">A3 = np.array([[0, 0, 0] * (i-1) + [2 * (k[i] - k[i-1])**3, 3 * (k[i] - k[i-1])**2, 6 * (k[i] - k[i-1])] + [0, 0, 0] * (n-i) for i in range(1, n+1)])
</code></pre>
<p>(While it includes <span class="arithmatex">\(k_i\)</span> terms, the same substitution in <span class="arithmatex">\(\mathbf{b}_3\)</span> results in no change.)</p>
<p>Now we need <span class="arithmatex">\(2\)</span> more equations, from two boundary conditions.</p>
<h2 id="boundary-conditions">Boundary conditions</h2>
<h3 id="zero-slope-boundary-conditions-variant">"Zero-slope boundary conditions" variant</h3>
<p>In the "zero-slope boundary conditions" variant, the slope (first derivative) of the spline's endpoints are prescribed to be zero. Therefore,</p>
<div class="arithmatex">\[ f_1'(k_0) = 0 \implies 2 a_1 k_0 + b_1 = 0 \]</div>
<div class="arithmatex">\[ f_n'(k_n) = 0 \implies 2 a_n k_n + b_n = 0 \]</div>
<p>This represents another <span class="arithmatex">\(2\)</span> linear equations, which can be expressed in the form <span class="arithmatex">\(A_4\mathbf{x}=\mathbf{b}_4\)</span>, where <span class="arithmatex">\(\mathbf{x}\)</span> is the same as before and:</p>
<div class="arithmatex">\[ \mathbf{b}_4 = \begin{bmatrix} 0 &amp; 0 \end{bmatrix}^\mathrm{T} \]</div>
<pre><code class="language-python">b4 = np.array([[0], [0]])
</code></pre>
<div class="arithmatex">\[
A_4 =
\begin{bmatrix}
    2 k_0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; \cdots &amp; 2 k_n &amp; 1 &amp; 0
\end{bmatrix}
\]</div>
<pre><code class="language-python">A4 = np.array([[2 * k[0], 1, 0] + [0, 0, 0] * (n-1), [0, 0, 0] * (n-1) + [2 * k[n], 1, 0]])
</code></pre>
<p>Replacing <span class="arithmatex">\(k_0\)</span> and <span class="arithmatex">\(k_n\)</span> with zero and <span class="arithmatex">\(k_n-k_{n-1}\)</span> respectively yields:</p>
<div class="arithmatex">\[
A_4 =
\begin{bmatrix}
    0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; \cdots &amp; 2 (k_n - k_{n-1}) &amp; 1 &amp; 0
\end{bmatrix}
\]</div>
<pre><code class="language-python">A4 = np.array([[0, 1, 0] + [0, 0, 0] * (n-1), [0, 0, 0] * (n-1) + [2 * (k[n] - k[n-1]), 1, 0]])
</code></pre>
<h3 id="zero-curvature-boundary-conditions-variant">"Zero-curvature boundary conditions" variant</h3>
<p>In the "zero-curvature boundary conditions" variant, the curvature (second derivative) of the spline's endpoints are prescribed to be zero. Therefore,</p>
<div class="arithmatex">\[ f_1''(k_0) = 0 \implies 2 a_1 = 0 \]</div>
<div class="arithmatex">\[ f_n''(k_n) = 0 \implies 2 a_n = 0 \]</div>
<p>This represents another <span class="arithmatex">\(2\)</span> linear equations, which can be expressed in the form <span class="arithmatex">\(A_4\mathbf{x}=\mathbf{b}_4\)</span>, where <span class="arithmatex">\(\mathbf{x}\)</span> is the same as before, <span class="arithmatex">\(\mathbf{b}_4\)</span> is the same as above, and:</p>
<div class="arithmatex">\[
A_4 =
\begin{bmatrix}
    2 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; \cdots &amp; 2 &amp; 0 &amp; 0
\end{bmatrix}
\]</div>
<pre><code class="language-python">A4 = np.array([[2, 0, 0] + [0, 0, 0] * (n-1), [0, 0, 0] * (n-1) + [2, 0, 0]])
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>